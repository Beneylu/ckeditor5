<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>CKEditor 5 – classic editor build – development sample</title>
	<style>
		body {
			max-width: 800px;
			margin: 20px auto;
		}
	</style>
</head>
<body>

<h1>CKEditor 5 – classic editor build – development sample</h1>

<button id="removeAnnotation">remove 1st annotation</button>

<div id="editor">
	<h2>Sample</h2>

	<p>This is an instance of the <a href="https://ckeditor.com/docs/ckeditor5/latest/builds/guides/overview.html#classic-editor">classic editor build</a>.</p>

	<p>Wayfarers craft beer four dollar toast readymade. Drinking  <span data-bns-annotation="VERB" data-bns-annotation-guid="11111111-2222-3333-4444-555555555555">vinegar <strong>taiyaki</strong> thundercats</span>, keffiyeh yr YOLO shaman ramps asymmetrical post-ironic lo-fi air plant everyday <span data-bns-annotation="NONE" data-bns-annotation-guid="22222222-2222-3333-4444-555555555555">carry woke marfa</span>. Plaid franzen leggings, actually humblebrag twee tote bag portland jean shorts. 8-bit keffiyeh distillery chicharrones, leggings la croix photo booth kale chips iceland poutine banjo seitan you probably haven't heard of them.</p>
	<p>Gluten-free kogi scenester, <span data-bns-annotation="NOUN" data-bns-annotation-guid="33333333-2222-3333-4444-555555555555">swag <span data-bns-annotation="NONE" data-bns-annotation-guid="44444444-2222-3333-4444-555555555555">bitters</span> hell</span> of wayfarers stumptown palo santo paleo lyft succulents. Waistcoat meggings fashion axe lumbersexual organic hoodie. Biodiesel chartreuse cliche intelligentsia lyft four dollar toast polaroid waistcoat 90's, glossier organic fixie bushwick kale chips. Meditation celiac migas, hoodie humblebrag tbh blog single-origin coffee man braid. Quinoa kombucha pop-up letterpress jean shorts cliche brooklyn cred whatever. Cardigan chartreuse neutra tumblr sartorial craft beer locavore bushwick wayfarers cred yr vexillologist skateboard. Pinterest vape pug venmo letterpress synth, helvetica seitan.</p>
	<p>Authentic literally slow-carb, edison bulb street art brunch mumblecore bitters activated charcoal portland. Portland everyday carry tumeric bushwick celiac church-key. Chillwave authentic venmo meditation post-ironic fanny pack hammock 3 wolf moon selvage. Tumblr edison bulb squid actually lomo humblebrag readymade cred blue bottle thundercats flannel mustache roof party. Butcher enamel pin fixie williamsburg, tousled polaroid vice tumblr hammock hashtag banh mi. Neutra pitchfork trust fund XOXO, gluten-free enamel pin godard intelligentsia single-origin coffee.</p>

	<figure class="image">
		<img src="../tests/manual/sample.jpg" alt="Autumn fields" />
	</figure>

	<p>You can use this sample to validate whether your <a href="https://ckeditor.com/docs/ckeditor5/latest/builds/guides/development/custom-builds.html">custom build</a> works fine.</p>
</div>

<script src="../build/ckeditor.js"></script>
<script>
	ClassicEditor.create( document.querySelector( '#editor' ) , {
		simpleUpload: {
			// Feature configuration.
			uploadUrl: 'https://beneylu.dev/ent/api/1.0.1537869525045/media-library/media/home/file?reload=true',
			withCredentials: false,
		},
		animatedEmojis: {
			// Feature configuration.
			baseURI: '/mnt/d/Work/ckeditor5/packages/ckeditor5-animated-emojis/theme/128px/',
		}
	}
		)
		.then( editor => {
			window.editor = editor;
			editor.on('change:data', function (evt) {
				console.log('change');
				console.log(evt);
			})

			editor.on('open-medialibrary', function (evt) {
				console.log('medialibrary');
			})

			editor.on('annotation:add', function (evt, data) {
				console.log('annotation');
				console.log(evt);
				console.log(data);
			})
			editor.model.schema.extend( 'image', { allowAttributes: 'src' } );

			editor.conversion.for( 'upcast' ).attributeToAttribute( {
				view: 'src',
				model: 'src'
			} );

			editor.conversion.for( 'downcast' ).add( dispatcher => {
				editor.conversion.for( 'dataDowncast' ).add( dispatcher => {
					dispatcher.on(
							'attribute:src',
							( evt, data, conversionApi ) => {
								console.log(evt);
								if ( !conversionApi.consumable.test( data.item, 'attribute:linkHref' ) ) {
									return;
								}

								if ( data.attributeNewValue ) {
									data.attributeNewValue += `#time=${ ( new Date() ).getTime() }`;
								}
							},
							{ priority: 'high' }
					);
				} );
			} );

			document.getElementById('removeAnnotation').onclick = () => {
				editor.fire('annotation:remove', { guid: '11111111-2222-3333-4444-555555555555' });
			};

		} )
		.catch( error => {
			console.error( 'There was a problem initializing the editor.', error );
		} );
</script>

</body>
</html>
